---
title: "MPDW AR MA ARMA"
author: "Dimas Ragamulia M0401231901"
date: "2025-09-21"
output: html_document
---

# Proses MA(2)

## Membangkitkan Model MA(2) dengan $\theta_1 = 0.4$ dan $\theta_2 = 0.6$ sebanyak 300 observasi

### Manual

```{r}
set.seed(1234)
wn <- rnorm(300)          

ma <- wn[1]      
ma[2] <- wn[2] + 0.4*wn[1]  

for(i in 3:300){
   ma[i] <- wn[i] + 0.4*wn[i - 1] + 0.6*wn[i - 2]
}
ma
```

### arima.sim

```{r}
set.seed(1234)
ma2 <- arima.sim(list(order = c(0,0,2), ma = c(0.4, 0.6)), n = 300)
ma2
```
Perbedaan hasil pembangkitan MA(2) secara manual dan dengan `arima.sim` muncul karena perlakuan nilai awal dan white noise yang berbeda. Meski realisasi datanya tidak sama, keduanya tetap memiliki sifat teoritis yang sama, yaitu rata-rata nol, varians konstan, dan ACF terputus di lag ke-2.


## Plot Time Series

### Plot ACF

```{r}
acf(ma,lag.max = 20)
```
Berdasarkan plot AFC tersebut, terlihat bahwa plot ACF cut-off di lag kedua

### Plot PACF

```{r}
pacf(ma)
```
Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF cenderung *tails off*.


### Plot EACF

```{r}
TSA::eacf(ma)
```
Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(2)

Plot ACF, PACF, dan EACF mengidentifikasi bahwa proses ini sesuai dengan model MA(2) yang artinya stasioner

## Scatterplot Antar Lag

### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
# Yt
yt_ma1 <- ma[-1]        
# Yt-1
yt_1_ma <- ma[-length(ma)]   

plot(y = yt_ma1, x = yt_1_ma,
     main = "Scatterplot Yt vs Yt-1")

cor(yt_ma1, yt_1_ma)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Nilai korelasi juge bernilai > 0 (0.528) yang artinya terdapat korelasi positif

### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
# Yt
yt_ma2 <- ma[-c(1,2)]   
# Yt-2
yt_2_ma <- ma[-c((length(ma)-1), length(ma))] 

plot(y = yt_ma2, x = yt_2_ma,
     main = "Scatterplot Yt vs Yt-2")

cor(yt_ma2, yt_2_ma)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-2}$ namun tidak sekuat hubungan antara $Y_t$ dengan $Y_{t-1}$. Nilai korelasi juge bernilai > 0 (0.435) yang artinya terdapat korelasi positif 

### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
# Yt
yt_ma3 <- ma[-c(1,2,3)]   
# Yt-3
yt_3_ma <- ma[-c((length(ma)-2):length(ma))]   

plot(y = yt_ma3, x = yt_3_ma,
     main = "Scatterplot Yt vs Yt-3")

cor(yt_ma3, yt_3_ma)
```
Berdasarkan scatterplot tersebut, terlihat bahwa cenderung tidak terdapat hubungan antara $Y_t$ dengan $Y_{t-3}$. Nilai korelasi juge bernilai > 0 (0.085) yang artinya terdapat korelasi positif walaupun nilainya sangat kecil mendekati 0


## Autokorelasi dari data bangkitan dan data teoritis

### Data bangkitan

```{r}
acf_empiris <- acf(ma, lag.max = 20, plot = FALSE)
acf_empiris$acf
```

### Data teoritis

```{r}
theta <- c(0.4, 0.6)
sigma2 <- 1

# gamma(0)
gamma0 <- sigma2 * (1 + sum(theta^2))

# gamma(1)
gamma1 <- sigma2 * (theta[1] + theta[1]*theta[2])

# gamma(2)
gamma2 <- sigma2 * theta[2]

# rho
rho1 <- gamma1 / gamma0
rho2 <- gamma2 / gamma0

c(rho1, rho2)
```

# Proses AR(2)

## Membangkitkan Model AR(2) dengan $\phi_1 = 0.5$ dan $\phi_2 = 0.2$ sebanyak 300 observasi

### Manual

```{r}
set.seed(1234)
# Bangkitkan white noise
wn <- rnorm(300, mean=0, sd=1)

# Inisialisasi
n <- length(wn)
ar <- numeric(n)
ar[1:2] <- wn[1:2]

# Loop AR(2)
for (i in 3:n) {
  ar[i] <- wn[i] + 0.5*ar[i-1] + 0.2*ar[i-2]
}
ar
```

### arima.sim

```{r}
ar2 <- arima.sim(list(order=c(2,0,0), ar=c(0.5,0.2)), n=300)
ar2
```
Hasil pembangkitan AR(2) dengan cara manual dan menggunakan `arima.sim()` berbeda karena sumber white noise serta perlakuan nilai awalnya tidak sama. Pada metode manual, nilai awal ditetapkan secara langsung dan dihitung dengan rumus rekursif, sedangkan `arima.sim()` menentukan kondisi awal berdasarkan asumsi stasioneritas proses AR. Oleh karena itu, meski parameternya sama, data yang dihasilkan tidak identik.


## Plot Time Series

### Plot ACF

```{r}
acf(ar)
```
Berdasarkan plot ACF tersebut terlihat bahwa plot ACF cenderung *tails off*.

### Plot PACF

```{r}
pacf(ar)
```
Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF *cuts off* pada lag kedua

### Plot EACF

```{r}
TSA::eacf(ar)
```
Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(1) dan ordo MA(1)

EACF bisa mengidentifikasi data AR(2) sebagai ARMA(1,1) karena keterbatasan metode, sampel yang kecil, pengaruh white noise, serta kecenderungan mengganti orde AR dengan komponen MA kecil.


## Scatterplot Antar Lag

### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
# Yt
yt_ar1 <- ar[-1]        
# Yt-1
yt_1_ar <- ar[-length(ar)]   

plot(y = yt_ar1, x = yt_1_ar,
     main = "Scatterplot Yt vs Yt-1")

cor(yt_ar1, yt_1_ar)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Nilai korelasi juge bernilai > 0 (0.716) yang artinya terdapat korelasi positif 

### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
# Yt
yt_ar2 <- ar[-c(1,2)]   
# Yt-2
yt_2_ar <- ar[-c((length(ar)-1), length(ar))] 

plot(y = yt_ar2, x = yt_2_ar,
     main = "Scatterplot Yt vs Yt-2")

cor(yt_ar2, yt_2_ar)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-2}$. Nilai korelasi juge bernilai > 0 (0.585) yang artinya terdapat korelasi positif

### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
# Yt
yt_ar3 <- ar[-c(1,2,3)]   
# Yt-3
yt_3_ar <- ar[-c((length(ar)-2):length(ar))]   

plot(y = yt_ar3, x = yt_3_ar,
     main = "Scatterplot Yt vs Yt-3")

cor(yt_ar3, yt_3_ar)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-3}$.Nilai korelasi juge bernilai > 0 (0.460) yang artinya terdapat korelasi positif 

## Autokorelasi dari data bangkitan dan data teoritis

### Data bangkitan

```{r}
acf_empiris <- acf(ar, lag.max = 20, plot = FALSE)
acf_empiris$acf
```

### Data teoritis

```{r}
phi <- c(0.5, 0.2) 
# rho(0) 
rho0 <- 1 
# rho(1) 
rho1 <- phi[1] / (1 - phi[2]) 
# rho(2) dan seterusnya pakai rekursi 
rho <- numeric(21) 
rho[1] <- rho0 
rho[2] <- rho1 
for (k in 3:21) { 
  rho[k] <- phi[1] * rho[k-1] + phi[2] * rho[k-2] 
  } 
rho
```

# Proses ARMA(2,2)

## Membangkitkan Model MA(2) dengan $\theta_1 = 0.4$, $\theta_2 = 0.6$, $\phi_1 = 0.5$, dan $\phi_2 = 0.2$ sebanyak 300 observasi

### Manual

```{r}
set.seed(1234)

wn <- rnorm(300, mean = 0, sd = 1)

arma_manual <- numeric(n)
e <- wn
arma_manual[1:2] <- e[1:2]   

for (t in 3:n) {
  arma_manual[t] <- 0.5 * arma_manual[t-1] +
                    0.2 * arma_manual[t-2] +
                    e[t] + 0.4 * e[t-1] + 0.6 * e[t-2]
}
arma_manual
```

### arima.sim

```{r}
set.seed(1234)

arma_sim <- arima.sim(
  list(order = c(2,0,2),
       ar = c(0.5, 0.2),
       ma = c(0.4, 0.6)),
  n = 300
)
arma_sim
```

## Plot Time Series

### Plot ACF

```{r}
par(mfrow = c(1, 2))
acf(arma_manual)
acf(arma_sim)
par(mfrow = c(2, 2))
```
Berdasarkan plot ACF tersebut, terlihat bahwa model ARMA(2,2) hasil simulasi memiliki plot ACF yang *tails off*

### Plot PACF

```{r}
par(mfrow = c(1, 2))
pacf(arma_manual)
pacf(arma_sim)
par(mfrow = c(2, 2))
```
Berdasarkan plot PACF tersebut, terlihat bahwa model ARMA(2,2) hasil simulasi memiliki plot PACF yang *tails off*

```{r}
TSA::eacf(arma_manual)
TSA::eacf(arma_sim)
```
Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(1) dan ordo MA(2).

Perbedaan hasil EACF yang mengidentifikasi ARMA(2,2) sebagai ARMA(1,2) terjadi karena keterbatasan metode dan sampel terbatas, sehingga pola nol pada autokorelasi tidak jelas. Kombinasi parameter tertentu juga dapat membuat struktur ARMA(2,2) menyerupai ARMA(1,2).

## Scatterplot Antar Lag

### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
# Yt
yt_arma <- arma_sim[-1]        
# Yt-1
yt_1_arma <- arma_sim[-length(arma_sim)]   

plot(y = yt_arma, x = yt_1_arma,
     main = "Scatterplot Yt vs Yt-1")

cor(yt_arma, yt_1_arma)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$.Nilai korelasi juge bernilai > 0 (0.891) yang artinya terdapat korelasi positif 

### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
# Yt
yt_arma2 <- arma_sim[-c(1,2)]   
# Yt-2
yt_2_arma <- arma_sim[-c((length(arma_sim)-1), length(arma_sim))] 

plot(y = yt_arma2, x = yt_2_arma,
     main = "Scatterplot Yt vs Yt-2")

cor(yt_arma2, yt_2_arma)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $_Y_t$ dengan $_Y_{t−2}$.Nilai korelasi juge bernilai > 0 (0.885) yang artinya terdapat korelasi positif 

### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
# Yt
yt_arma3 <- arma_sim[-c(1,2,3)]   
# Yt-3
yt_3_arma <- arma_sim[-c((length(arma_sim)-2):length(arma_sim))]   

plot(y = yt_arma3, x = yt_3_arma,
     main = "Scatterplot Yt vs Yt-3")

cor(yt_arma3, yt_3_arma)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $_Y_t$ dengan $Y_{t−3}$. Nilai korelasi juge bernilai > 0 (0.604) yang artinya terdapat korelasi positif 

## Autokorelasi dari data bangkitan dan data teoritis

### Data bangkitan

```{r}
acf_empiris <- acf(arma_manual, lag.max = 20, plot = FALSE)
acf_empiris$acf
```

### Data teoritis

```{r}
acf_teoritis <- ARMAacf(ar = c(0.5, 0.2), ma = c(0.4, 0.6), lag.max = 20)
acf_teoritis
```